<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <title>Automation Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>

<body>

<header>
  <h1>AIzen Automation</h1>
  <img src="AIzen.png" alt="Logo" class="logo">
</header>

<nav>
  <a href="index.html">Home</a>
  <a href="form.html">Form</a>
</nav>

<main class="container">
  <section class="box">
    <h2>Daten für Automation einreichen</h2>

    <form id="automationForm" enctype="multipart/form-data">
      <label for="username">Name:</label>
      <input type="text" name="username" id="username" required>

      <label for="message">Beschreibung</label>
      <textarea id="message" name="message" rows="4" placeholder="Was soll automatisiert werden?"></textarea>

      <label for="file">Datei hochladen:</label>
      <input type="file" name="file" id="file">

      <button type="submit">Absenden</button>
      <button type="reset">Formular leeren</button>

      <!-- Statusanzeige -->
      <p id="statusMessage" style="display:none;"></p>
    </form>

  </section>
</main>

<footer>
  <p>© 2026 Kaizen</p>
</footer>

<script>
/* ========== PASSWORT SCHUTZ ========== */
const password = "4711";
const userPass = prompt("Bitte Passwort eingeben:");

if (userPass !== password) {
  document.body.innerHTML = "<h1 style='text-align:center;margin-top:50px;'>Zugriff verweigert</h1>";
  throw new Error("Access denied");
}

/* ========== FORM LOGIK ========== */
const form = document.getElementById("automationForm");
const statusMessage = document.getElementById("statusMessage");

const webhookUrl = "https://n8n.srv1220381.hstgr.cloud/webhook/d5a74c1a-d778-487a-9987-ac4dea6e9ea2";

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  statusMessage.style.display = "block";
  statusMessage.style.color = "black";
  statusMessage.textContent = "Sende Daten...";

  const formData = new FormData(form);

  try {
    const response = await fetch(webhookUrl, {
      method: "POST",
      body: formData
    });

    if (response.ok) {
      statusMessage.style.color = "green";
      statusMessage.textContent = "✅ Daten wurden erfolgreich gesendet!";
      form.reset();
    } else {
      statusMessage.style.color = "red";
      statusMessage.textContent = "❌ Fehler beim Senden der Daten";
    }
  } catch (error) {
    statusMessage.style.color = "red";
    statusMessage.textContent = "❌ Verbindung zu n8n fehlgeschlagen";
  }
});
</script>

<script type="text/javascript">
  (function(d, t) {
      var v = d.createElement(t), s = d.getElementsByTagName(t)[0];
      v.onload = function() {
        window.voiceflow.chat.load({
          verify: { projectID: '69712f3f394d4cc164741123' },
          url: 'https://general-runtime.voiceflow.com',
          versionID: 'production',
          voice: {
            url: "https://runtime-api.voiceflow.com"
          }
        });
      }
      v.src = "https://cdn.voiceflow.com/widget-next/bundle.mjs"; v.type = "text/javascript"; s.parentNode.insertBefore(v, s);
  })(document, 'script');
</script>

</body>
</html>

